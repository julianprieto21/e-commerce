---
import AddToCart from "@/components/AddToCart";
import Gallery from "@/components/Gallery";
import BaseLayout from "@/layouts/BaseLayout.astro";
import { CATEGORIES } from "@/lib/CATEGORIES";
import { formatPrice } from "@/lib/utils";

export async function getStaticPaths() {
  const paths = CATEGORIES.map((category) =>
    category.items.map((item) => ({
      params: { cid: category.id, sid: item.id },
    }))
  );
  return paths.flat();
}

const { cid, sid } = Astro.params;
const [category] = CATEGORIES.filter((cat) => cat.id == cid);
const shirt = category.items.find((item) => item.id == sid);

if (!shirt) {
  return new Response("Shirt not found", { status: 404 });
}
---

<BaseLayout title={`${category.name} | ${shirt.name}`} >
<main class="mt-14 mx-44 flex flex-row items-start justify-start">
  <Gallery images={shirt.images} category={category} client:only="react" />
  <section class="flex-col flex py-4 gap-4">
    <h1 class="text-5xl font-base text-left w-full">Camiseta de {shirt.name}</h1>
    <h2 class="font-light text-3xl text-neutral-700">{formatPrice(shirt.price)}</h2>
    <AddToCart product={shirt} client:only="react" />
  </section>
</main>
</BaseLayout>

